<!doctype html>
<html lang="en-us">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1,shrink-to-fit=no">


  <link rel="icon" type="image/png" sizes="32x32" href="https://res.cloudinary.com/deo07tbou/image/upload/">
  <link rel="icon" type="image/x-icon" href="https://res.cloudinary.com/deo07tbou/image/upload/">
  <link rel="apple-touch-icon" href="https://res.cloudinary.com/deo07tbou/image/upload/">
  <link rel="canonical" href="https://www.juanorozco.com/blog/2023/long-term-power-outage/">
<link rel="preload" as="style" href="/bundle.css?v=1737045152" media="all">
<link rel="stylesheet" href="/bundle.css?v=1737045152" media="all">
<style>.cdata pre{background-color:#1f2937;color:#e5e7eb}.cdata :not(pre)>code{background-color:#f3f4f6;color:#7c3aed}.chroma .err{background-color:#991b1b;color:#fecaca}.chroma .hl{background-color:#374151}.chroma .ln{color:#9ca3af}.chroma .k,.chroma .kc,.chroma .kd,.chroma .kn,.chroma .kp,.chroma .kr{color:#60a5fa}.chroma .kt{color:#a78bfa}.chroma .na,.chroma .nb{color:#fbbf24}.chroma .nc{color:#f87171}.chroma .no{color:#34d399}.chroma .nd{color:#f87171}.chroma .ne{color:#f87171}.chroma .nf{color:#fbbf24}.chroma .nt{color:#f87171}.chroma .l{color:#a78bfa}.chroma .dl,.chroma .ld,.chroma .s,.chroma .s2,.chroma .sa,.chroma .sb,.chroma .sc,.chroma .sd{color:#34d399}.chroma .se{color:#9ca3af}.chroma .s1,.chroma .sh,.chroma .si,.chroma .sr,.chroma .ss,.chroma .sx{color:#34d399}.chroma .il,.chroma .m,.chroma .mb,.chroma .mf,.chroma .mh,.chroma .mi,.chroma .mo{color:#a78bfa}.chroma .o,.chroma .ow{color:#93c5fd}.chroma .c,.chroma .c1,.chroma .ch,.chroma .cm,.chroma .cp,.chroma .cpf,.chroma .cs,.chroma .p{color:#9ca3af}.chroma .ge{font-style:italic}.chroma .gs{font-weight:700}
</style>



<title>Long Term Power Outage : Juan Orozco</title>

<meta property="og:title" content="Long Term Power Outage">
<meta property="og:site_name" content="Juan Orozco">
<meta property="og:url" content="https://www.juanorozco.com/blog/2023/long-term-power-outage/">
<link rel="image_src" href="https://res.cloudinary.com/deo07tbou/image/upload/">
<meta property="og:image" content="https://res.cloudinary.com/deo07tbou/image/upload/">
<meta property="og:image:width" content="">
<meta property="og:image:height" content="">
<meta property="og:type" content="article">
<meta property="og:locale" content="en_us">
<meta property="og:description" content="Using a Raspberry Pi as a DNS server is not a good idea. Most computers have an internal clock, or a &quot;Real Time Clock&quot;. Pi&#39;s don&#39;t. So, say a natural disaster leads to an extended power outage, the iternal clock will be off and that can cause some fun DNS issues.">
<meta name="description" content="Using a Raspberry Pi as a DNS server is not a good idea. Most computers have an internal clock, or a &quot;Real Time Clock&quot;. Pi&#39;s don&#39;t. So, say a natural disaster leads to an extended power outage, the iternal clock will be off and that can cause some fun DNS issues.">
<meta property="og:updated_time" content="2023-08-24T04:53:00Z">
<meta property="fb:app_id" content="">
<meta name="author" content="Juan Orozco">
<meta property="article:author" content="https://juanorozco.com/">
<meta property="article:published_time" content="2023-08-24T04:53:00Z">
<meta property="article:modified_time" content="2023-08-24T04:53:00Z">
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "Article",
  "headline": "Long Term Power Outage",
  "alternativeHeadline": "Using a Raspberry Pi as a DNS server is not a good idea. Most computers have an internal clock, or a \u0026quot;Real Time Clock\u0026quot;. Pi's don't. So, say a natural disaster leads to an extended power outage, the iternal clock will be off and that can cause some fun DNS issues.",
  "url": "https://www.juanorozco.com/blog/2023/long-term-power-outage/",
  "image": "https://res.cloudinary.com/deo07tbou/image/upload/",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://www.juanorozco.com/blog/2023/long-term-power-outage/"
  },
  "description": "Using a Raspberry Pi as a DNS server is not a good idea. Most computers have an internal clock, or a \u0026quot;Real Time Clock\u0026quot;. Pi's don't. So, say a natural disaster leads to an extended power outage, the iternal clock will be off and that can cause some fun DNS issues.",
  "author": {
    "@type": "Person",
    "name": "Juan Orozco"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Juan Orozco",
    "logo": {
      "@type": "ImageObject",
      "url": "https://res.cloudinary.com/deo07tbou/image/upload/"
    }
  },
  "datePublished": "2023-08-24T04:53:00Z",
  "dateModified": "2023-08-24T04:53:00Z",
  "articleBody": "\u003cp\u003eUsing a Raspberry Pi as a DNS server is not a good idea. Most computers have an internal clock, or a \u0026quot;Real Time Clock\u0026quot;. \u003cstrong\u003ePi's don't.\u003c/strong\u003e So, say a natural disaster leads to an extended power outage, the iternal clock will be off and that can cause some fun DNS issues.\u003c/p\u003e\n\u003cp\u003e\u0026quot;So? Just update the clock,\u0026quot; I hear. Well, yea, that's what I ended up doing ... once we got power back after four days. The problem is, though, that when local DNS goes down for the family internet, people are liable to get realy grumpy. \u003cem\u003eEspecially\u003c/em\u003e after already dealing with no power, no hot water, and no internet.\u003c/p\u003e\n\u003cdiv class=\"flex items-center justify-center font-content-sans rounded bg-blue-100 px-4 py-4\" role=\"alert\"\u003e\n  \u003cspan class=\"text-xs font-bold uppercase leading-none rounded-full text-blue-100 bg-blue-500 px-2 py-1 mr-3\"\u003eHrm...\u003c/span\u003e\n  \u003cspan class=\"font-semibold text-blue-700\"\u003eThere are people that have lost homes and more in the recent fires. I don't mean to compare my silly DNS issues to their pain; this is just something I would like to document with a lighthearted story and I hope everyone affected is safe and sound.\u003c/span\u003e\n\u003c/div\u003e\n\n\u003cp\u003eLocal disaster relief efforts located industrial generators that are no powering our small town. Once they turned the grid back on, I was able to reboot all my hardware. That's when I found that all requests to the internet were failing.\u003c/p\u003e\n\u003ch2 id=\"identifying-the-problem\"\u003eIdentifying the problem\u003c/h2\u003e\n\u003cp\u003eThe first thing I did was check the logs in the Starlink advanced tab - it reported that it could access the internet. I then checked my router and pinged google, also good. That's when I knew the issue was with Pihole and DNS.\u003c/p\u003e\n\u003cp\u003eI changed the DNS server on my machine to Google's DNS, \u003ccode\u003e8.8.8.8\u003c/code\u003e and the internet started to work again! I made the change at the router and restarted everything again. At this point, I wasn't sure why the Pi was failing to resolve DNS but to make sure my kids didn't revolt on me, I just went ahead and got things working.\u003c/p\u003e\n\u003cp\u003eOnce that was back up, I could now spend the time to investigate why Pihole was acting up. I've had issues with DNS servers having the wrong clock before and this felt very familiar.\u003c/p\u003e\n\u003cp\u003eI ssh'd into the Pi and checked its current time by running \u003ccode\u003edate\u003c/code\u003e. The power was cut on the 18th around 4:30 pm pacific time and that's exactly what the Pi was reporting as the current time.\u003c/p\u003e\n\u003ch2 id=\"fixing-the-problem\"\u003eFixing the problem\u003c/h2\u003e\n\u003cp\u003eI made sure that timezone was correct by using \u003ccode\u003eraspi-config\u003c/code\u003e and then tried to run an update. \u003ccode\u003eupdate\u003c/code\u003e failed with an odd message - again, making me feel like the time was the issue. So, I went ahead and overwrote the Pi's time:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-shell\"\u003e# Turn off ntpupdate first otherwise set-time will fail\nsudo timedatectl set-ntp no\nsudo timedatectl set-time “2023-08-23 20:15:00”\nsudo timedatectl set-ntp yes\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eWith this done, I ran update for Raspbian, updated Pihole, and added it back to my computer's DNS server. Et viola, it worked again!\u003c/p\u003e\n\u003ch2 id=\"conclusion\"\u003eConclusion\u003c/h2\u003e\n\u003cp\u003eIt's really interesting running into this problem - we don't really get power outages that last more than a few hours now-a-days. If the clock was off by a few hours, it probably would have been fine. Being off by days wreaked a lot of havoc on my home network. My TP-Link Deco's, for example, without DNS, would not load the Deco app. I love my Deco's but that was really frustrating to see \u0026quot;Deco not found\u0026quot;.\u003c/p\u003e\n\u003cp\u003eA Raspberry Pi, especially an old Pi 2, makes for a great DNS widget and since the power grid is mostly robust, the lack of a Real Time Clock isn't always a problem. Still, being able to \u003ca href=\"/blog/2023/long-term-power-outage/#fixing-the-problem\"\u003equickly fix the time\u003c/a\u003e or maybe adding one of \u003ca href=\"https://learn.adafruit.com/adding-a-real-time-clock-to-raspberry-pi/overview\"\u003ethese RTC modules\u003c/a\u003e would prevent this issue in the future.\u003c/p\u003e"
}
</script>

<link rel="preload" as="script" href="/bundle.js?v=1737045152">


</head>
<body>

  <header id="nav" class="header">
  <div class="ax-l-i max-w-6xl">
    <div class="ax-logo">
      <a class="block" href="/" title="Juan Orozco"><span class="font-semibold text-raven-900">Juan Orozco</span></a>
    </div>
    <div class="ax-user">
      <a class="p-2 w-8 h-8 block text-raven-500 hover:text-gray-800 focus:text-gray-800 focus:outline-none" target="_blank" rel="noopener nofollow" href="https://www.google.com/search?q=site:juanorozco.com" title="">
        <svg class="fill-current" viewBox="0 0 32 32" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M2.67 12.804c0-5.6 4.544-10.134 10.133-10.134s10.134 4.544 10.134 10.134-4.544 10.133-10.134 10.133S2.67 18.393 2.67 12.804zm28.943 16.923l-8.868-8.868c4.287-5.3 3.68-13.012-1.378-17.57S8.564-1.066 3.75 3.75s-5.017 12.558-.46 17.618 12.28 5.665 17.57 1.378l8.868 8.868a1.33 1.33 0 0 0 2.231-.597c.123-.46-.008-.952-.345-1.29h0z"/></svg>

      </a>
      <a class="p-2 block text-base leading-none text-raven-500 hover:text-gray-800 focus:text-gray-800 focus:outline-none" href="/now/">
        Now
      </a>
      <a class="p-2 block text-base leading-none text-raven-500 hover:text-gray-800 focus:text-gray-800 focus:outline-none" href="/blog/">
        Blog
      </a>
      <a class="p-2 block text-base leading-none text-raven-500 hover:text-gray-800 focus:text-gray-800 focus:outline-none" href="/docs/">
        Docs
      </a>
      <a class="p-2 block text-base leading-none text-raven-500 hover:text-gray-800 focus:text-gray-800 focus:outline-none" href="/photography/">
        Photography
      </a>
    </div>
  </div>

  
</header>

  <main>
<div class="default-single">
  <div class="ax-title ax-l-o">
    <div class="ax-l-i max-w-680">
      <h1 class="post-title font-content-title font-normal leading-tight tracking-default text-40">Long Term Power Outage</h1>

      <div class="ax-meta flex items-center mt-5">
        <div class="flex-grow min-w-0">
          <div class="flex items-center">
  <div class="flex-shrink-0">
    <img
    class="w-12 h-12 sm:w-14 sm:h-14 object-cover p-3px rounded-full border border-blue-300"
    src="https://res.cloudinary.com/deo07tbou/image/upload/v1584979170/juan-orozco-com/juan-orozco.jpg"
    alt="Juan Orozco">
  </div>
  <div class="flex-shrink-0 ml-2 leading-tight font-content-sans">
    <a class="block text-sm text-raven-800 hover:text-raven-900 hover:underline focus:underline" target="_blank" rel="noopener nofollow" title="Juan Orozco" href="https://juanorozco.com/">Juan Orozco</a>
    <time class="text-sm text-raven-500" datetime="2023-08-24T04:53:00Z">Aug 24, 2023 4:53AM</time>
  </div>
</div>

        </div>
        <div>
          <div class="flex items-center">
    <a class="flex-shrink-0 block text-raven-800 hover:text-raven-900" target="_blank" rel="noopener nofollow" title="" href="https://twitter.com/intent/tweet?text=Long%20Term%20Power%20Outage%20by%20%40%25%21s%28%3cnil%3e%29%20https%3a%2f%2fwww.juanorozco.com%2fblog%2f2023%2flong-term-power-outage%2f"><svg class="w-6 h-6 fill-current" viewBox="0 0 32 32" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M32 6.078c-1.2.522-2.458.868-3.78 1.036 1.36-.812 2.398-2.088 2.886-3.626a13.11 13.11 0 0 1-4.16 1.588C25.742 3.794 24.026 3 22.154 3a6.56 6.56 0 0 0-6.556 6.562c0 .52.044 1.02.152 1.496-5.454-.266-10.28-2.88-13.522-6.862-.566.982-.898 2.106-.898 3.316a6.57 6.57 0 0 0 2.914 5.452 6.48 6.48 0 0 1-2.964-.808v.072c0 3.188 2.274 5.836 5.256 6.446-.534.146-1.116.216-1.72.216-.42 0-.844-.024-1.242-.112.85 2.598 3.262 4.508 6.13 4.57a13.18 13.18 0 0 1-8.134 2.798c-.538 0-1.054-.024-1.57-.1C2.906 27.93 6.35 29 10.064 29c12.072 0 18.672-10 18.672-18.668 0-.3-.01-.57-.024-.848C30.014 8.56 31.108 7.406 32 6.078z"/></svg>
</a>
    <a class="ml-3 flex-shrink-0 block text-raven-800 hover:text-raven-900" target="_blank" rel="noopener nofollow" title="" href="https://www.facebook.com/dialog/share?app_id=&display=page&href=https%3a%2f%2fwww.juanorozco.com%2fblog%2f2023%2flong-term-power-outage%2f"><svg class="w-6 h-6 fill-current" viewBox="-7 -3.5 39 39" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M30.234 0H1.765C.8.001 0 .79 0 1.766v28.47C.001 31.2.79 32 1.766 32h15.328V19.625h-4.156V14.78h4.156v-3.564c0-4.134 2.523-6.384 6.21-6.384 1.766 0 3.284.13 3.726.2v4.32h-2.543c-2.006 0-2.394.953-2.394 2.352v3.085h4.797l-.625 4.844h-4.172V32h8.14C31.21 32 32 31.2 32 30.234V1.765C32 .8 31.21 0 30.234 0z"/></svg>
</a>
</div>
        </div>
      </div>
    </div>
  </div><div class="ax-content ax-l-o">
    <div class="ax-l-i max-w-680">
      <article class="cdata">
<p>Using a Raspberry Pi as a DNS server is not a good idea. Most computers have an internal clock, or a &quot;Real Time Clock&quot;. <strong>Pi's don't.</strong> So, say a natural disaster leads to an extended power outage, the iternal clock will be off and that can cause some fun DNS issues.</p>
<p>&quot;So? Just update the clock,&quot; I hear. Well, yea, that's what I ended up doing ... once we got power back after four days. The problem is, though, that when local DNS goes down for the family internet, people are liable to get realy grumpy. <em>Especially</em> after already dealing with no power, no hot water, and no internet.</p>
<div class="flex items-center justify-center font-content-sans rounded bg-blue-100 px-4 py-4" role="alert">
  <span class="text-xs font-bold uppercase leading-none rounded-full text-blue-100 bg-blue-500 px-2 py-1 mr-3">Hrm...</span>
  <span class="font-semibold text-blue-700">There are people that have lost homes and more in the recent fires. I don't mean to compare my silly DNS issues to their pain; this is just something I would like to document with a lighthearted story and I hope everyone affected is safe and sound.</span>
</div>

<p>Local disaster relief efforts located industrial generators that are no powering our small town. Once they turned the grid back on, I was able to reboot all my hardware. That's when I found that all requests to the internet were failing.</p>
<h2 id="identifying-the-problem">Identifying the problem</h2>
<p>The first thing I did was check the logs in the Starlink advanced tab - it reported that it could access the internet. I then checked my router and pinged google, also good. That's when I knew the issue was with Pihole and DNS.</p>
<p>I changed the DNS server on my machine to Google's DNS, <code>8.8.8.8</code> and the internet started to work again! I made the change at the router and restarted everything again. At this point, I wasn't sure why the Pi was failing to resolve DNS but to make sure my kids didn't revolt on me, I just went ahead and got things working.</p>
<p>Once that was back up, I could now spend the time to investigate why Pihole was acting up. I've had issues with DNS servers having the wrong clock before and this felt very familiar.</p>
<p>I ssh'd into the Pi and checked its current time by running <code>date</code>. The power was cut on the 18th around 4:30 pm pacific time and that's exactly what the Pi was reporting as the current time.</p>
<h2 id="fixing-the-problem">Fixing the problem</h2>
<p>I made sure that timezone was correct by using <code>raspi-config</code> and then tried to run an update. <code>update</code> failed with an odd message - again, making me feel like the time was the issue. So, I went ahead and overwrote the Pi's time:</p>
<pre><code class="language-shell"># Turn off ntpupdate first otherwise set-time will fail
sudo timedatectl set-ntp no
sudo timedatectl set-time “2023-08-23 20:15:00”
sudo timedatectl set-ntp yes
</code></pre>
<p>With this done, I ran update for Raspbian, updated Pihole, and added it back to my computer's DNS server. Et viola, it worked again!</p>
<h2 id="conclusion">Conclusion</h2>
<p>It's really interesting running into this problem - we don't really get power outages that last more than a few hours now-a-days. If the clock was off by a few hours, it probably would have been fine. Being off by days wreaked a lot of havoc on my home network. My TP-Link Deco's, for example, without DNS, would not load the Deco app. I love my Deco's but that was really frustrating to see &quot;Deco not found&quot;.</p>
<p>A Raspberry Pi, especially an old Pi 2, makes for a great DNS widget and since the power grid is mostly robust, the lack of a Real Time Clock isn't always a problem. Still, being able to <a href="/blog/2023/long-term-power-outage/#fixing-the-problem">quickly fix the time</a> or maybe adding one of <a href="https://learn.adafruit.com/adding-a-real-time-clock-to-raspberry-pi/overview">these RTC modules</a> would prevent this issue in the future.</p>

      </article>
      

      

    </div>
  </div>
</div>

  </main>
  <footer class="footer">
  <div class="ax-l-i max-w-6xl">
    <nav class="flex items-center justify-center">
      <a class="ml-3 first:ml-0 text-sm text-gray-600 hover:text-gray-800" href="/blog/">Blog</a>
      <a class="ml-3 first:ml-0 text-sm text-gray-600 hover:text-gray-800" href="/now/">Now</a>
    </nav>

    <div class="footer-copyright text-sm text-center text-gray-400 mt-4">
      &#169; 2025-2025 Juan Orozco
    </div>
    <div class="text-sm sm:text-xs text-center text-gray-400 mt-2">
       <a href="%!s(<nil>)?utm_source=theme-footer&utm_medium=website&utm_campaign=referral">%!s(<nil>)</a>
    </div>
  </div>
</footer>

<script src="/bundle.js?v=1737045152"></script>


</body>
</html>
